## Introduction

DDM is KubeMove framework's plugin, which migrate the data across the cluster.
In cluster, only one instance of DDM should be running at a time. If multiple
instance of same DDM are running in a cluster then only one of the instance will
be functional through the instance life-cycle.

This document explains how to write a DDM for an application.
_For complete code, refer cmd/dummy_plugin/dummy_plugin.go_

## Interface
DDM is supposed two have two main functionality,
    1. Initialization
    2. Synchronization of  data

This two functionality is implemented through `Plugin` interface.
```
type Plugin interface {                                           
      Init(map[string]string) error
      Sync(string, bool, map[string]string, []*Volume) (string, error)
      Status(string) (int32, error)
}    
```
`Plugin` interface have three method which supports initialization and migration of data.

### Init method
Goal of `Init` method is to initialize the plugin with the given configuration. `Init` method is
invoked once only throughout the plugin life-cycle.

### Sync method

Goal of `Sync` method is to migrate/sync application data to remote cluster. `Sync` method can
be invoked multiple times asynchronously.
Signature of `Sync` method is as below

`Sync(MoveEngineName string, IsActive bool, Params map[string]string, VolList []*Volume) (SyncId string, error)`

- `MoveEngineName` : MoveEngine name for current migration

- `IsActive` : Is this migration/sync being executed in active cluster. Active cluster is source cluster for                    migration. If plugin is running in destination cluster then `IsActive` will be `false`.

- `Params` : Plugin related parameters from MoveEngine CR

- `VolList` : List of volumes for given application

- `SyncID` : Unique id generated by given plugin in response to `sync` call. This unique id will be used to 
           check the status of sync further.

### Status method

`Status` method is responsible to get the status of sync.

`Status(SyncID string) (status int32, error)`
- SyncID : unique id per sync
- status : status value for sync
            Value can be:

            - Completed : Migration is completed

            - InProgress : Migration is in progress

            - Invalid : Given SyncID is invalid 

            - Canceled : Migration of given SyncID is canceled

            - Errored : Migration of given SyncID is errored

    _Note: Above values are from pkg/plugin/ddm/plugin_